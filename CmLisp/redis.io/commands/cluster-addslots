<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <title>CLUSTER ADDSLOTS â€“ Redis</title>
    <link href='/styles.css' rel='stylesheet'>
    <link href='/images/favicon.png' rel='shortcut icon'>
    <link href='/opensearch.xml' rel='search' title='Look up a Redis command' type='application/opensearchdescription+xml'>
    <meta content='width=device-width, minimum-scale=1.0, maximum-scale=1.0' name='viewport'>
    <script>
       var _gaq = _gaq || [];
       _gaq.push(['_setAccount', 'UA-20243082-1']);
       _gaq.push(['_trackPageview']);
      
       (function() {
         var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
         ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
         var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
       })();
    </script>
  </head>
  <body class=''>
    <div class='mobile-menu slideout-menu'>
      <header class='menu-header'></header>
      <section class='menu-section'>
        <ul class='menu-section-list'>
          <li>
            <a class='home' href='/'>Home</a>
          </li>
          <li>
            <a href='/commands'>Commands</a>
          </li>
          <li>
            <a href='/clients'>Clients</a>
          </li>
          <li>
            <a href='/documentation'>Documentation</a>
          </li>
          <li>
            <a href='/community'>Community</a>
          </li>
          <li>
            <a href='/download'>Download</a>
          </li>
          <li>
            <a href='/modules'>Modules</a>
          </li>
          <li>
            <a href='/support'>Support</a>
          </li>
        </ul>
      </section>
    </div>
    <div class='site-wrapper'>
      <header class='site-header'>
        <nav class='container'>
          <div class='mobile-header'>
            <button class='btn-hamburger js-slideout-toggle'>
              <span class='fa fa-bars'></span>
            </button>
            <a class='home' href='/'>
              <img alt='Redis' src='/images/redis-white.png'>
            </a>
          </div>
          <div class='desktop-header'>
            <a class='home' href='/'>
              <img alt='Redis' src='/images/redis-white.png'>
            </a>
            <a href='/commands'>Commands</a>
            <a href='/clients'>Clients</a>
            <a href='/documentation'>Documentation</a>
            <a href='/community'>Community</a>
            <a href='/download'>Download</a>
            <a href='/modules'>Modules</a>
            <a href='/support'>Support</a>
          </div>
        </nav>
      </header>
      <div class='site-content'>
        <div class='text'>
          <h1 class='command'>
            <span class='name'>CLUSTER ADDSLOTS</span>
            <span class='arg'>slot [slot ...]</span>
          </h1>
          <article>
            <div class='article-main'>
              <div class='metadata'>
                <p><strong>Available since 3.0.0.</strong></p>
                <p><strong>Time complexity:</strong> O(N) where N is the total number of hash slot arguments</p>
              </div>
              <p>This command is useful in order to modify a node&#39;s view of the cluster
              configuration. Specifically it assigns a set of hash slots to the node
              receiving the command. If the command is successful, the node will map
              the specified hash slots to itself, and will start broadcasting the new
              configuration.</p>
              
              <p>However note that:</p>
              
              <ol>
              <li>The command only works if all the specified slots are, from the point of view of the node receiving the command, currently not assigned. A node will refuse to take ownership for slots that already belong to some other node (including itself).</li>
              <li>The command fails if the same slot is specified multiple times.</li>
              <li>As a side effect of the command execution, if a slot among the ones specified as argument is set as <code>importing</code>, this state gets cleared once the node assigns the (previously unbound) slot to itself.</li>
              </ol>
              
              <span id="example" class=anchor></span><h2 ><a href="#example" class=anchor-link>*</a>Example</h2>
              
              <p>For example the following command assigns slots 1 2 3 to the node receiving
              the command:</p>
              
              <pre><code>&gt; CLUSTER ADDSLOTS 1 2 3&#x000A;OK&#x000A;</code></pre>
              
              <p>However trying to execute it again results into an error since the slots
              are already assigned:</p>
              
              <pre><code>&gt; CLUSTER ADDSLOTS 1 2 3&#x000A;ERR Slot 1 is already busy&#x000A;</code></pre>
              
              <span id="usage-in-redis-cluster" class=anchor></span><h2 ><a href="#usage-in-redis-cluster" class=anchor-link>*</a>Usage in Redis Cluster</h2>
              
              <p>This command only works in cluster mode and is useful in the following
              Redis Cluster operations:</p>
              
              <ol>
              <li>To create a new cluster ADDSLOTS is used in order to initially setup master nodes splitting the available hash slots among them.</li>
              <li>In order to fix a broken cluster where certain slots are unassigned.</li>
              </ol>
              
              <span id="information-about-slots-propagation-and-warnings" class=anchor></span><h2 ><a href="#information-about-slots-propagation-and-warnings" class=anchor-link>*</a>Information about slots propagation and warnings</h2>
              
              <p>Note that once a node assigns a set of slots to itself, it will start
              propagating this information in heartbeat packet headers. However the
              other nodes will accept the information only if they have the slot as
              not already bound with another node, or if the configuration epoch of the
              node advertising the new hash slot, is greater than the node currently listed
              in the table.</p>
              
              <p>This means that this command should be used with care only by applications
              orchestrating Redis Cluster, like <code>redis-trib</code>, and the command if used
              out of the right context can leave the cluster in a wrong state or cause
              data loss.</p>
              
              <span id="return-value" class=anchor></span><h2 ><a href="#return-value" class=anchor-link>*</a>Return value</h2>
              
              <p><a href="/topics/protocol#simple-string-reply">Simple string reply</a>: <code>OK</code> if the command was successful. Otherwise an error is returned.</p>
            </div>
            <div class='article-aside'>
              <aside>
                <h2>
                  Related commands
                </h2>
                <ul>
                  <li>
                    <a href='/commands/cluster-addslots'>
                      <strong>CLUSTER ADDSLOTS</strong>
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-count-failure-reports'>
                      CLUSTER COUNT-FAILURE-REPORTS
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-countkeysinslot'>
                      CLUSTER COUNTKEYSINSLOT
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-delslots'>
                      CLUSTER DELSLOTS
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-failover'>
                      CLUSTER FAILOVER
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-forget'>
                      CLUSTER FORGET
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-getkeysinslot'>
                      CLUSTER GETKEYSINSLOT
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-info'>
                      CLUSTER INFO
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-keyslot'>
                      CLUSTER KEYSLOT
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-meet'>
                      CLUSTER MEET
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-nodes'>
                      CLUSTER NODES
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-replicas'>
                      CLUSTER REPLICAS
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-replicate'>
                      CLUSTER REPLICATE
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-reset'>
                      CLUSTER RESET
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-saveconfig'>
                      CLUSTER SAVECONFIG
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-set-config-epoch'>
                      CLUSTER SET-CONFIG-EPOCH
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-setslot'>
                      CLUSTER SETSLOT
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-slaves'>
                      CLUSTER SLAVES
                    </a>
                  </li>
                  <li>
                    <a href='/commands/cluster-slots'>
                      CLUSTER SLOTS
                    </a>
                  </li>
                  <li>
                    <a href='/commands/readonly'>
                      READONLY
                    </a>
                  </li>
                  <li>
                    <a href='/commands/readwrite'>
                      READWRITE
                    </a>
                  </li>
                </ul>
              </aside>
            </div>
          </article>
        </div>
      </div>
      <footer class='site-footer'>
        <div class='container'>
          <p>
            This website is
            <a href="https://github.com/antirez/redis-io">open source software</a>.
            See all <a href="/topics/sponsors">credits</a>.
          </p>
          <div class='sponsor'>
            Sponsored by
            <a href='https://redislabs.com/'>
              <img alt='Redis Labs' height='25' src='/images/redislabs.png' title='Get a Managed Redis' width='128'>
            </a>
          </div>
        </div>
      </footer>
    </div>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js'></script>
    <script src='/app.js?1480208557'></script>
  </body>
</html>
